---
layout: post
title:  "串口 COM口 USB-TTL RS-232 RS-485 不同标准 区别 释疑"
date:   2016-11-30 10:09:35
categories: [其他]
tags: [硬件, RS232, TTL, ]
description: ""
---

有几个概念玩嵌入式的同志经常搞混。也不怨谁，现在的卖家为了一点可怜的销量都在故意混淆串口的概念。
如果你发现本文有哪里含糊，或者任何一点有可能影响理解的地方，请留言，我会修正以便帮助后来的朋友。

## Point (所有要点都在这，请仔细阅读)：
1. 串口、COM口是指的物理接口形式(硬件)。而TTL、RS-232、RS-485指的是串口的电平标准(电信号)。
2. 接线的时候，一般只接GND、RX(接收)、TX(发送)。不接Vcc等电源线，避免与目标设备上的供电冲突。
      （接线法则：主机的 TX 接目标设备的 RX ，主机的 RX 接目标设备的 TX ，但是很多设计人员为了接线更为直观而故意颠倒标记 RX、TX，可以串200-1kΩ电阻之后尝试交换。或No.4的方法。）
3. 串口通讯一般不含握手协议，所以可以只接GND、RX用于纯接收，或只接GND、TX用于纯发送。
4. 串口接线错误可能会烧坏芯片，比如：一个TX拉高的1 灌到了 另一个TX拉低的0。
      （不确定目标接线定义的时候，可以拿确定为RX的线 试接 另一个设备的TX和RX，看是否收到数据。）
5. CH340、PL2303、CP2102、FT232R 芯片是 USB转成串口(TTL电平输出)的芯片，需要安装Windows驱动。
      （常用于笔记本增加串口，注意其兼容性不如板载串口。优先选择：FT232R > CP2102 > PL2303 ）
6. MAX232 是TTL电平与RS232电平的 双向转换芯片，不同引脚实现TTL转RS-232 或 RS-232转TTL的功能。
      （TTL与RS232转换芯片很多很多，正向、逆向接口数量不同：比如：MAX202、SP213、MAX3232 ）
7. TTL电平标准 是 低电平为0，高电平为1（对GND线电压，标准数字电路逻辑）。
   RS-232电平标准 是 正电平为0，负电平为1（对GND线高低，电压具体数值不太敏感）。
8. RS-485、RS-422 与RS-232类似，但是采用差分信号逻辑，更适合抗干扰/高速传输。这里略过不讲。
9. 台式电脑后边的D型9针插头（板载串口，公口），是RS-232电平的。可以通过MAX232转换为TTL电平

## 串口、COM口
COM口 即 串行通讯端口，简称 串口。这里区别于 USB的“通用串行总线”和“SATA”串行硬盘接口。
一般我们见到的是两种物理形式。D型9针插头（DB9）和 4针杜邦头 两种，早年的25针串口已被淘汰。

下图是常见的4针串口，在电路板上常见，经常上边还带有杜邦插针。
四针分别为：GND、TX、RX、VCC。其中GND可以通过焊盘接地判断出来，而VCC一般走线稍粗些。
由于是预留在电路板上的，协议可以有很多种，要看具体设备。

![图 1.](/images/others/6566538dt9b5fccf2db43&690.jpg)
![图 1.](/images/others/001R856lgy6GGvrdRYL73&690.jpg)
![图 1.](/images/others/001R856lgy6GGvriyyXbf&690.jpg)

经验是：不管单片机也好、ARM也罢，这些芯片都是数字逻辑的，电平只有高和低，输出肯定是TTL电平的。
如果你看到串口线从核心芯片直接连出来，未经其他芯片，那99%是TTL的。STC下载和中九升级都属此范畴。
我目前还未拆出过直接输出RS-232的数字逻辑器件。
 
下图就是D型9针串口(通俗说法，DB9)，左为母口，右为公口。公口在台式电脑后边都可以看到。
      (VGA插头为三排插针，DB9只有两排。有些板载串口没有引出，主板找标记“RS232”的10脚牛角座既是)

![图 2.](/images/others/6566538dt9b5fc030f2e7&690.jpg)

DB9接口的协议常用的只有三种：RS-232、RS-485和RS-422。一般不会是TTL电平，嵌入式设备80%的可能性是RS-232，工业控制设备80%可能是RS-485。
其中RS-232在DB9上的针脚定义有标准规范，跨行业/跨设备通用，而RS-485和RS-422基本只有企业规范了。
9针RS-232串口的完整定义可以[参考这里](http://wenku.baidu.com/view/5c170c6925c52cc58bd6be6e.html)

---

下图是个USB转TTL串口的小板(TTL电平)，可以用USB扩展出一个串口。芯片为PL2303HX。
淘宝卖家经常故意混淆各种串口，但是这个确实是可以给 STC单片机下载程序 和 升级中九盒子的。

![图 3.](/images/others/6566538dt9b607c5325e6&690.jpg)

这是另一种，CP2102芯片的，也是USB转串口(TTL电平)。据说比PL2303的好，实际使用中表现并不明显。
这个小板引出了芯片内置的LDO，多了个+3.3V 电源输出端，可以用于驱动小电流的负载设备。

![图 3.](/images/others/6566538dt9b601bffe6e0&690.jpg)

在这里说一下，TTL电平还有不同电压的区别，常见3.3V和5V版本。比如某板的核心芯片为3.3V，那么它输出的逻辑1就是3.3V。这个转接板和5V的设备对接，电压触发阈值一般可以满足，建议串470-1k电阻做保险。
除了PL232和CP2102，还有CH340和FT232之类的USB转TTL芯片，不再详述。

----

上边介绍的都是USB转TTL电平的串口，如果目标设备上是RS-232串口(D型9针接口)咋弄？
再 串接一片 MAX232 转换成 RS-232电平就行，一个MAX232内部有两个T，两个R，下图只用了一组T/R。

![图 4.](/images/others/001R856lgy6WrSsg6p369&690.gif)

你也可以搭一个简单的比较器电路，来实现TTL转RS-232的功能，仔细看图有助于理解电平的概念。
    （注意下图中TTL端的GND-TTL与GND232分开考虑。红色为TTL转RS232功能部分，蓝色为RS232转TTL。）

![图 5.](/images/others/001R856lgy6Y8gP6VaG7a&690.png)

（这里插播一点我的电路体系：在没涉及电磁波之前，电压这个东西可以当它不存在，电子流动所表现出来的电流才是分析的主体，电流受到阻碍，才会在两端体现出压差。电压永远是差值，某点对某点的差值，然而所有课本总是封装成整套的高级理论一股脑砸给初学者，导致了很多人一辈子都未能形成统一的电路体系。就下边这个电路来说，TxTTL电压大于12/(6.8+1)V时，运放开启了Rx232对GND-TTL的通路。然后我们视线转移到右侧两个560Ω的电阻上，GND232对GND-TTL是6V，而Rx232与GND-TTL相通，那么Rx232对GND232不就是 负6V么？这是一个参考系的转移，右侧电路并不知道GND-TTL的存在，只知道Rx232与GND232之间的压差。那么，多出来的 负6伏不会有额外的电流么？这就是我说的问题，这其实是同一批电流流经下方560Ω电阻，在电阻两端所产生的压差，Get？电子流动受阻表现出电压，反映到系统里边呈现出两端的压差，而不是电压产生电流。咦，哪里不对？运放的输入为什么要用电压来考虑？因为运放太复杂，运放设计时就花了很大力气去优化电流路径使之表现出更好的电压特性，用封装起来的电压体系去分析运放的外部表现比较容易理解。既然是电流产生电压，那驱动电子流动的能量是什么？举个例子就明白了，水塔。水塔内部控制的还是进水的流速，经过水池的缓冲，对外表现出水压的一致，这就是我们看到的恒压源。水压和流速都是水分子集总表现出来的宏观性状/现象，而不是水流动的原因，重力才是。对电路来说，驱动电子的是沿电路形成的电场，其根源在于电源单向搬移电子的速度。变压器+整流桥不就是液压造浪机+单向阀么？）
扯远了。
MAX232内置了倍压电路来实现升压/负压，所以不需要上图所示的正负电源。
同时带来一个特征，倍压电路需要多个蓄能电容，芯片内部做不下，可以依此在接口附近找芯片确定串口电平

----

当然，早有人想到了做一款成品。USB转RS-232串口。
仔细看下图(从右到左)，USB经过PL2303转成了TTL串口(中间那四个窟窿可以引出)，再经由MAX232转换为RS-232电平，9针串口引出。（公口，泛指所有带针的口，样子与台式电脑后边自带的串口相同。）

![图 6.](/images/others/6566538dt9b5fc04f7465&690.jpg)

下面这是另一款：电平转换依旧用的是 MAX232 ，大同小异。
注意这个输出好像是母口，跟电脑后边的接口不同，千万不要买错性别。

![图 7.](/images/others/6566538dt9b5fc0404732&690.jpg)

进阶：MAX232只能转换两个T和两个R，无法实现完整的9针全串口电平转换，所以此类串口转接板只有TX、RX和GND三针有效，对于涉及到串口中其他控制线的目标设备不适用。（PL2303等芯片都转出了TTL电平的全部引脚，只不过MAX232通道数量有限，所以DB9一端很少功能完整的串口。若要全串口电平转换，MAX3232可以实现。）

你或许会买到如下图这种：看起来里边只有一个牛屎芯片的。
但是记住一点，只要是 D型9针串口，不会是TTL电平的，没特殊说明就默认是RS-232。
所以这根线，不管里边构造怎样的，是 USB转RS-232串口 的线，内置了电平转换芯片。
如果想用来给STC单片机下载或者升级中九盒子，需要额外再串接一个MAX232板子 转换回 TTL电平

![图 8.](/images/others/6566538dt9b5fc06df457&690.jpg)



{% highlight ruby %}
文档信息
--------------
* 版权声明：自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）
* 转载: [http://blog.sina.com.cn/s/blog_6566538d0100r7p8.html]
{% endhighlight %}



[jekyll]:      http://jekyllrb.com
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-help]: https://github.com/jekyll/jekyll-help
